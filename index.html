<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Nghe vÃ  Viáº¿t ChÃ­nh Táº£: My First Sentences</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #ec407a; /* Há»“ng */
            --primary-dark: #c2185b;
            --success-color: #4caf50;
            --error-color: #f44336;
            --light-bg: #fce4ec;
            --text-color: #333;
            --white-color: #ffffff;
            --yellow-color: #ffc107;
            /* MÃ u cho cÃ¡c nÃºt chá»§ Ä‘á» */
            --topic-color-1: #ef5350; /* Äá» nháº¡t */
            --topic-color-2: #42a5f5; /* Xanh dÆ°Æ¡ng */
            --topic-color-3: #66bb6a; /* Xanh lÃ¡ */
            --topic-color-4: #ffa726; /* Cam */
            --topic-color-5: #ab47bc; /* TÃ­m */
        }
        body {
            font-family: 'Nunito', sans-serif;
            background: linear-gradient(120deg, #f8bbd0 0%, #ce93d3 100%);
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            color: var(--text-color);
            overscroll-behavior: none;
            -webkit-tap-highlight-color: transparent;
        }
        .container {
            text-align: center;
            padding: 25px;
            max-width: 900px;
            width: 95%;
            background: var(--white-color);
            border-radius: 24px;
            box-shadow: 0 10px 35px rgba(0, 0, 0, 0.1), 0 4px 15px rgba(0, 0, 0, 0.05);
            box-sizing: border-box;
        }
        .game-title {
            font-size: clamp(1.8em, 5vw, 2.5em);
            color: var(--primary-color);
            margin: 0 0 5px;
            font-weight: 700;
        }
        .game-subtitle {
            font-size: clamp(1.2em, 4vw, 1.5em);
            margin-bottom: 20px;
            color: #555;
            font-weight: 600;
        }
        .meaning {
            font-size: clamp(1.1em, 4.5vw, 1.6em);
            color: var(--primary-dark);
            margin: 15px 0;
            font-style: italic;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }
        .input-container {
            position: relative;
            margin: 30px 0;
        }
        #answerInput {
            width: 100%;
            padding: 15px 20px;
            font-size: clamp(1.1em, 4vw, 1.6em);
            font-family: 'Nunito', sans-serif;
            border-radius: 12px;
            border: 3px solid var(--primary-color);
            box-sizing: border-box;
            text-align: center;
            transition: all 0.3s ease;
        }
        #answerInput:focus {
            outline: none;
            box-shadow: 0 0 0 4px rgba(236, 64, 122, 0.3);
        }
        #answerInput.correct {
            border-color: var(--success-color);
            background-color: #e8f5e9;
        }
        #answerInput.incorrect {
            border-color: var(--error-color);
            animation: shake 0.5s;
        }
        #hint {
            display: none;
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 15px 25px;
            border-radius: 12px;
            font-size: clamp(1.1em, 4vw, 1.6em);
            font-weight: 600;
            pointer-events: none;
            z-index: 10;
            width: max-content;
            max-width: 90%;
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-8px); }
            75% { transform: translateX(8px); }
        }
        .buttons {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 15px;
            margin: 20px 0;
        }
        button {
            background: var(--primary-color);
            color: var(--white-color);
            border: none;
            padding: 12px 28px;
            border-radius: 12px;
            font-size: clamp(0.9em, 3.5vw, 1.1em);
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            touch-action: manipulation;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }
        button:hover, button:focus {
            transform: translateY(-2px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2);
            outline: none;
        }
        button#resetBtn { background-color: #757575; }
        button#resetBtn:hover { background-color: #616161; }
        button#checkBtn { background-color: var(--success-color); }
        button#checkBtn:hover { background: #388e3c; }
        button#hintBtn { background-color: var(--yellow-color); color: var(--text-color); }
        button#hintBtn:hover { background-color: #ffb300; }
        button:disabled {
            background: #bdbdbd;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        .score {
            font-size: clamp(1.1em, 4vw, 1.4em);
            margin-top: 20px;
            font-weight: 600;
            color: var(--primary-dark);
        }
        .message {
            font-size: clamp(1.1em, 4vw, 1.4em);
            color: var(--error-color);
            margin: 15px 0;
            font-weight: 700;
            min-height: 25px;
        }
        canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }
        .start-screen, .topic-selection-screen, .topic-congrats-screen {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }
        #startBtn, .topic-btn, .congrats-btn {
            padding: 15px 40px;
            font-size: 1.2em;
            border-radius: 16px;
            width: 90%;
            max-width: 450px;
        }
        #startBtn { background-color: var(--success-color); }
        #startBtn:hover { background: #388e3c; }
        .topic-btn-color-1 { background-color: var(--topic-color-1); }
        .topic-btn-color-1:hover { background-color: #d32f2f; }
        .topic-btn-color-2 { background-color: var(--topic-color-2); }
        .topic-btn-color-2:hover { background-color: #1976d2; }
        .topic-btn-color-3 { background-color: var(--topic-color-3); }
        .topic-btn-color-3:hover { background-color: #388e3c; }
        .topic-btn-color-4 { background-color: var(--topic-color-4); }
        .topic-btn-color-4:hover { background-color: #f57c00; }
        .topic-btn-color-5 { background-color: var(--topic-color-5); }
        .topic-btn-color-5:hover { background-color: #8e24aa; }
        #playerNameInput {
            font-family: 'Nunito', sans-serif;
            font-size: 1.2em;
            padding: 10px 15px;
            border-radius: 12px;
            border: 2px solid var(--primary-color);
            text-align: center;
            width: 80%;
            max-width: 300px;
        }
        #playerNameInput:focus {
            outline: none;
            box-shadow: 0 0 0 3px rgba(236, 64, 122, 0.3);
        }
        @media (max-width: 600px) {
            .container { padding: 15px; }
            button { padding: 10px 20px; }
        }
    </style>
</head>
<body>
    <canvas id="fireworks"></canvas>
    <div class="container">
        <div class="game-title">NGHE VÃ€ VIáº¾T CHÃNH Táº¢</div>
        <div class="game-subtitle" id="gameSubtitle">(Dictation Practice)</div>
                
        <div class="start-screen" id="startScreen">
            <input type="text" id="playerNameInput" placeholder="Nháº­p tÃªn cá»§a báº¡n...">
            <button id="startBtn">Báº¯t Ä‘áº§u</button>
        </div>

        <div class="topic-selection-screen" id="topicSelectionScreen" style="display: none;">
            <!-- Topic buttons will be generated here -->
        </div>

        <div class="game-screen" id="gameScreen" style="display: none;">
            <div class="meaning" id="meaning"></div>
            <div class="input-container">
                <input type="text" id="answerInput" placeholder="Nháº­p cÃ¢u báº¡n nghe Ä‘Æ°á»£c..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
                <div id="hint"></div>
            </div>
            <div class="message" id="message"></div>
            <div class="buttons">
                <button id="listenAgainBtn">Nghe láº¡i</button>
                <button id="checkBtn">Kiá»ƒm tra</button>
                <button id="hintBtn">Gá»£i Ã½</button>
                <button id="resetBtn">Chá»§ Ä‘á» khÃ¡c</button>
            </div>
            <div class="score" id="score"></div>
        </div>

        <div class="topic-congrats-screen" id="topicCongratsScreen" style="display: none;">
            <div class="message" id="congratsMessage" style="color: var(--success-color); font-size: 1.5em;"></div>
            <button class="congrats-btn" id="playTopicAgainBtn">ChÆ¡i láº¡i chá»§ Ä‘á» nÃ y</button>
            <button class="congrats-btn" id="chooseAnotherTopicBtn">Chá»n chá»§ Ä‘á» khÃ¡c</button>
        </div>

    </div>

    <script>
    const topics = {
        "Chá»§ Ä‘á» 1: Báº¯t Ä‘áº§u": [
            { en: "In Britain, students have to wear uniforms when they go to school.", vi: "á» Anh, há»c sinh pháº£i máº·c Ä‘á»“ng phá»¥c khi Ä‘áº¿n trÆ°á»ng.", emoji: "ğŸ‡¬ğŸ‡§" },
            { en: "The teacher said that we should work harder on our pronunciation.", vi: "GiÃ¡o viÃªn nÃ³i ráº±ng chÃºng tÃ´i nÃªn luyá»‡n táº­p phÃ¡t Ã¢m chÄƒm chá»‰ hÆ¡n.", emoji: "ğŸ—£ï¸" },
            { en: "His mother told him not to leave the door unlocked.", vi: "Máº¹ cáº­u áº¥y báº£o cáº­u áº¥y Ä‘á»«ng Ä‘á»ƒ cá»­a má»Ÿ khÃ³a.", emoji: "ğŸ”’" },
            { en: "The chair is beside the door. \"Beside\" here means \"next to.\"", vi: "CÃ¡i gháº¿ á»Ÿ bÃªn cáº¡nh cá»­a. \"Beside\" á»Ÿ Ä‘Ã¢y cÃ³ nghÄ©a lÃ  \"next to.\"", emoji: "ğŸšª" },
            { en: "I couldn't make coffee for everybody. There weren't enough cups.", vi: "TÃ´i khÃ´ng thá»ƒ pha cÃ  phÃª cho má»i ngÆ°á»i. KhÃ´ng Ä‘á»§ tÃ¡ch.", emoji: "â˜•" },
            { en: "I'm studying very hard at the moment because I want to pass the exam.", vi: "Hiá»‡n táº¡i tÃ´i Ä‘ang há»c ráº¥t chÄƒm chá»‰ vÃ¬ tÃ´i muá»‘n vÆ°á»£t qua ká»³ thi.", emoji: "ğŸ“š" },
            { en: "In order to be highly paid, they work much harder.", vi: "Äá»ƒ Ä‘Æ°á»£c tráº£ lÆ°Æ¡ng cao, há» lÃ m viá»‡c chÄƒm chá»‰ hÆ¡n nhiá»u.", emoji: "ğŸ’°" },
            { en: "Smoking should be prohibited in public.", vi: "Cáº¥m hÃºt thuá»‘c á»Ÿ nÆ¡i cÃ´ng cá»™ng.", emoji: "ğŸš­" },
            { en: "Where does Mr. Brown work?", vi: "Ã”ng Brown lÃ m viá»‡c á»Ÿ Ä‘Ã¢u?", emoji: "â“" },
            { en: "You are responsible for your serious mistakes.", vi: "Báº¡n pháº£i chá»‹u trÃ¡ch nhiá»‡m vá» nhá»¯ng sai láº§m nghiÃªm trá»ng cá»§a mÃ¬nh.", emoji: "âš ï¸" },
            { en: "How often do they go camping?", vi: "Há» Ä‘i cáº¯m tráº¡i bao lÃ¢u má»™t láº§n?", emoji: "ğŸ•ï¸" },
            { en: "The climate is getting hotter and hotter.", vi: "KhÃ­ háº­u Ä‘ang ngÃ y cÃ ng nÃ³ng hÆ¡n.", emoji: "ğŸ”¥" },
            { en: "My sister isn't very keen on computer games.", vi: "Chá»‹ (em) gÃ¡i tÃ´i khÃ´ng thÃ­ch trÃ² chÆ¡i mÃ¡y tÃ­nh láº¯m.", emoji: "ğŸ®" },
            { en: "He thinks that chatting on the Internet is a waste of time.", vi: "Cáº­u áº¥y nghÄ© ráº±ng trÃ² chuyá»‡n trÃªn Internet lÃ  lÃ£ng phÃ­ thá»i gian.", emoji: " wasting time" },
            { en: "He bought his house with his own money.", vi: "Cáº­u áº¥y Ä‘Ã£ mua cÄƒn nhÃ  báº±ng tiá»n cá»§a chÃ­nh mÃ¬nh.", emoji: "ğŸ " },
            { en: "They marked the occasion with an open-air concert.", vi: "Há» Ä‘Ã¡nh dáº¥u dá»‹p nÃ y báº±ng má»™t buá»•i hÃ²a nháº¡c ngoÃ i trá»i.", emoji: "ğŸ¶" },
            { en: "Study hard or you'll fail the exam.", vi: "Há»c chÄƒm chá»‰ náº¿u khÃ´ng báº¡n sáº½ trÆ°á»£t ká»³ thi.", emoji: "ğŸ“" },
            { en: "Many people think that students have an easy life.", vi: "Nhiá»u ngÆ°á»i nghÄ© ráº±ng há»c sinh cÃ³ cuá»™c sá»‘ng dá»… dÃ ng.", emoji: "ğŸ’­" },
            { en: "Our post is delivered daily, except on Sunday.", vi: "ThÆ° cá»§a chÃºng tÃ´i Ä‘Æ°á»£c gá»­i hÃ ng ngÃ y, trá»« Chá»§ nháº­t.", emoji: "ğŸ“«" },
            { en: "Most paper is made from wood.", vi: "Háº§u háº¿t giáº¥y Ä‘Æ°á»£c lÃ m tá»« gá»—.", emoji: "ğŸŒ³" },
            { en: "On the other hand, there are some serious disadvantages.", vi: "Máº·t khÃ¡c, cÃ³ má»™t sá»‘ nhÆ°á»£c Ä‘iá»ƒm nghiÃªm trá»ng.", emoji: "â†”ï¸" },
            { en: "You have to pay a deposit if you want to use the motorbike.", vi: "Báº¡n pháº£i tráº£ tiá»n Ä‘áº·t cá»c náº¿u muá»‘n sá»­ dá»¥ng xe mÃ¡y.", emoji: "ğŸ›µ" },
            { en: "Did your flat mate use to clean the house?", vi: "Báº¡n cÃ¹ng phÃ²ng cá»§a báº¡n cÃ³ thÆ°á»ng dá»n dáº¹p nhÃ  khÃ´ng?", emoji: "â“" },
            { en: "These girls are not old enough to get married.", vi: "Nhá»¯ng cÃ´ gÃ¡i nÃ y chÆ°a Ä‘á»§ tuá»•i Ä‘á»ƒ káº¿t hÃ´n.", emoji: "ğŸ’" },
            { en: "He said \"Hello\" in a most friendly way.", vi: "Cáº­u áº¥y nÃ³i \"Xin chÃ o\" má»™t cÃ¡ch thÃ¢n thiá»‡n nháº¥t.", emoji: "ğŸ—£ï¸" },
            { en: "Binh wants to learn about auto mechanics.", vi: "BÃ¬nh muá»‘n há»c vá» cÆ¡ khÃ­ Ã´ tÃ´.", emoji: "ğŸš—" },
            { en: "The girl helping children in her free time is my friend.", vi: "CÃ´ gÃ¡i giÃºp Ä‘á»¡ tráº» em trong thá»i gian ráº£nh lÃ  báº¡n tÃ´i.", emoji: "ğŸ‘§" },
            { en: "I was drying the dishes when I dropped the plate.", vi: "TÃ´i Ä‘ang lau khÃ´ bÃ¡t Ä‘Ä©a thÃ¬ lÃ m rÆ¡i cÃ¡i Ä‘Ä©a.", emoji: "ğŸ½ï¸" },
            { en: "Milk bottles can be reused after being cleaned.", vi: "Chai sá»¯a cÃ³ thá»ƒ Ä‘Æ°á»£c tÃ¡i sá»­ dá»¥ng sau khi Ä‘Æ°á»£c lÃ m sáº¡ch.", emoji: "ğŸ¥›" },
            { en: "She arrived early in order to get a good seat.", vi: "CÃ´ áº¥y Ä‘áº¿n sá»›m Ä‘á»ƒ cÃ³ Ä‘Æ°á»£c má»™t chá»— ngá»“i tá»‘t.", emoji: "ğŸ’º" },
            { en: "You can answer these questions by mail.", vi: "Báº¡n cÃ³ thá»ƒ tráº£ lá»i nhá»¯ng cÃ¢u há»i nÃ y báº±ng thÆ°.", emoji: "âœ‰ï¸" },
            { en: "He locked the door so that nobody could disturb him.", vi: "Cáº­u áº¥y khÃ³a cá»­a láº¡i Ä‘á»ƒ khÃ´ng ai cÃ³ thá»ƒ lÃ m phiá»n.", emoji: "ğŸ¤«" },
            { en: "The ASEAN was established in 1967.", vi: "ASEAN Ä‘Æ°á»£c thÃ nh láº­p vÃ o nÄƒm 1967.", emoji: "ğŸŒ" },
            { en: "It is a four-hour drive from Thanh Hoa to Hanoi.", vi: "ÄÃ³ lÃ  má»™t chuyáº¿n lÃ¡i xe bá»‘n giá» tá»« Thanh HÃ³a Ä‘áº¿n HÃ  Ná»™i.", emoji: "ğŸš—" },
            { en: "They fly kites when they have free time.", vi: "Há» tháº£ diá»u khi cÃ³ thá»i gian ráº£nh.", emoji: "ğŸª" },
            { en: "They kept me waiting for twenty minutes.", vi: "Há» báº¯t tÃ´i Ä‘á»£i hai mÆ°Æ¡i phÃºt.", emoji: "â°" },
            { en: "My sister loves to watch the stars at night.", vi: "Chá»‹ (em) gÃ¡i tÃ´i thÃ­ch ngáº¯m sao vÃ o ban Ä‘Ãªm.", emoji: "â­" },
            { en: "Agriculture may cause environmental problems.", vi: "NÃ´ng nghiá»‡p cÃ³ thá»ƒ gÃ¢y ra cÃ¡c váº¥n Ä‘á» mÃ´i trÆ°á»ng.", emoji: "ğŸŒ" },
            { en: "One of the important skills in learning language is writing.", vi: "Má»™t trong nhá»¯ng ká»¹ nÄƒng quan trá»ng trong viá»‡c há»c ngÃ´n ngá»¯ lÃ  viáº¿t.", emoji: "âœï¸" },
            { en: "When does Razzie Award ceremony take place?", vi: "Lá»… trao giáº£i MÃ¢m XÃ´i VÃ ng diá»…n ra khi nÃ o?", emoji: "â“" },
            { en: "Phong doesn't like English. He is very bad at it.", vi: "Phong khÃ´ng thÃ­ch tiáº¿ng Anh. Cáº­u áº¥y ráº¥t kÃ©m mÃ´n nÃ y.", emoji: "ğŸ˜Ÿ" },
            { en: "They have known each other for a long time.", vi: "Há» Ä‘Ã£ biáº¿t nhau tá»« lÃ¢u.", emoji: "ğŸ¤" },
            { en: "Arthur apologized for hurting her feelings.", vi: "Arthur xin lá»—i vÃ¬ Ä‘Ã£ lÃ m tá»•n thÆ°Æ¡ng cáº£m xÃºc cá»§a cÃ´ áº¥y.", emoji: "ğŸ˜¥" },
            { en: "Put down your gun and put up your hands.", vi: "Äáº·t sÃºng xuá»‘ng vÃ  giÆ¡ tay lÃªn.", emoji: "âœ‹" },
            { en: "If I had a lot of money, I would buy a car.", vi: "Náº¿u tÃ´i cÃ³ nhiá»u tiá»n, tÃ´i sáº½ mua má»™t chiáº¿c Ã´ tÃ´.", emoji: "ğŸ’°" },
            { en: "People didn't talk on the phone one hundred years ago.", vi: "Má»i ngÆ°á»i khÃ´ng nÃ³i chuyá»‡n qua Ä‘iá»‡n thoáº¡i má»™t trÄƒm nÄƒm trÆ°á»›c.", emoji: "ğŸ“" },
            { en: "This pen costs twice as much as the other one.", vi: "CÃ¢y bÃºt nÃ y Ä‘áº¯t gáº¥p Ä‘Ã´i cÃ¢y kia.", emoji: "ğŸ’²" },
            { en: "He is delighted that you have paid attention to recycling.", vi: "Cáº­u áº¥y ráº¥t vui vÃ¬ báº¡n Ä‘Ã£ chÃº Ã½ Ä‘áº¿n viá»‡c tÃ¡i cháº¿.", emoji: "â™»ï¸" },
            { en: "We are taking our evening walk at the moment.", vi: "ChÃºng tÃ´i Ä‘ang Ä‘i dáº¡o buá»•i tá»‘i vÃ o lÃºc nÃ y.", emoji: "ğŸš¶" },
            { en: "He asked me where I would go the next day.", vi: "Cáº­u áº¥y há»i tÃ´i ngÃ y hÃ´m sau tÃ´i sáº½ Ä‘i Ä‘Ã¢u.", emoji: "â“" },
            { en: "Would you like to have a cup of coffee?", vi: "Báº¡n cÃ³ muá»‘n uá»‘ng má»™t tÃ¡ch cÃ  phÃª khÃ´ng?", emoji: "â˜•" },
            { en: "Every week, there are two flights from Ha Noi to Nha Trang.", vi: "Má»—i tuáº§n cÃ³ hai chuyáº¿n bay tá»« HÃ  Ná»™i Ä‘áº¿n Nha Trang.", emoji: "âœˆï¸" },
            { en: "How does the girl suggest to go by?", vi: "CÃ´ gÃ¡i Ä‘á» nghá»‹ Ä‘i báº±ng phÆ°Æ¡ng tiá»‡n gÃ¬?", emoji: "â“" },
            { en: "What's her full name? Her full name's Sarah Johnson.", vi: "TÃªn Ä‘áº§y Ä‘á»§ cá»§a cÃ´ áº¥y lÃ  gÃ¬? TÃªn Ä‘áº§y Ä‘á»§ cá»§a cÃ´ áº¥y lÃ  Sarah Johnson.", emoji: "ğŸ‘¤" },
            { en: "Supplying COVID-19 vaccines is not enough.", vi: "Cung cáº¥p váº¯c-xin COVID-19 lÃ  chÆ°a Ä‘á»§.", emoji: "ğŸ’‰" },
            { en: "My brother has a car but he does not use it very often.", vi: "Anh (em) trai tÃ´i cÃ³ má»™t chiáº¿c Ã´ tÃ´ nhÆ°ng cáº­u áº¥y khÃ´ng sá»­ dá»¥ng nÃ³ thÆ°á»ng xuyÃªn.", emoji: "ğŸš—" },
            { en: "What do you like best about your school?", vi: "Báº¡n thÃ­ch nháº¥t Ä‘iá»u gÃ¬ á»Ÿ trÆ°á»ng cá»§a báº¡n?", emoji: "â“" },
            { en: "Can you give me a ride?", vi: "Báº¡n cÃ³ thá»ƒ cho tÃ´i Ä‘i nhá» khÃ´ng?", emoji: "ğŸš—" },
            { en: "What is the boy with black hair doing?", vi: "Cáº­u bÃ© tÃ³c Ä‘en Ä‘ang lÃ m gÃ¬?", emoji: "ğŸ‘¦" },
            { en: "He set very difficult standards for himself.", vi: "Cáº­u áº¥y Ä‘áº·t ra nhá»¯ng tiÃªu chuáº©n ráº¥t khÃ³ cho báº£n thÃ¢n.", emoji: "ğŸ¯" },
        ],
        "Chá»§ Ä‘á» 2: Thá»­ thÃ¡ch": [
            { en: "A long time ago, Levis made his pants with blue cotton cloth called \"denim.\"", vi: "CÃ¡ch Ä‘Ã¢y ráº¥t lÃ¢u, Levis Ä‘Ã£ lÃ m quáº§n cá»§a mÃ¬nh báº±ng váº£i cotton mÃ u xanh gá»i lÃ  \"denim.\"", emoji: "ğŸ‘–" },
            { en: "Grocery store is a place where people can buy food and small things.", vi: "Cá»­a hÃ ng táº¡p hÃ³a lÃ  nÆ¡i má»i ngÆ°á»i cÃ³ thá»ƒ mua thá»©c Äƒn vÃ  nhá»¯ng thá»© nhá».", emoji: "ğŸ›’" },
            { en: "Peter used to write to me until last year. Now he sends me e-mail.", vi: "Peter Ä‘Ã£ tá»«ng viáº¿t thÆ° cho tÃ´i cho Ä‘áº¿n nÄƒm ngoÃ¡i. BÃ¢y giá» cáº­u áº¥y gá»­i e-mail cho tÃ´i.", emoji: "ğŸ“§" },
            { en: "Limestone is a type of white or gray stone containing calcium, used for building and making cement.", vi: "ÄÃ¡ vÃ´i lÃ  má»™t loáº¡i Ä‘Ã¡ mÃ u tráº¯ng hoáº·c xÃ¡m cÃ³ chá»©a canxi, Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ xÃ¢y dá»±ng vÃ  lÃ m xi mÄƒng.", emoji: "ğŸ§±" },
            { en: "The journey was quite different from what I thought it would be.", vi: "Chuyáº¿n Ä‘i khÃ¡ khÃ¡c so vá»›i nhá»¯ng gÃ¬ tÃ´i nghÄ©.", emoji: "ğŸ—ºï¸" },
            { en: "Thank you for waking me up. I was having a nightmare!", vi: "Cáº£m Æ¡n báº¡n Ä‘Ã£ Ä‘Ã¡nh thá»©c tÃ´i. TÃ´i Ä‘Ã£ gáº·p Ã¡c má»™ng!", emoji: "ğŸ˜¨" },
            { en: "The secretary will arrange for you to visit our factory next week.", vi: "ThÆ° kÃ½ sáº½ sáº¯p xáº¿p Ä‘á»ƒ báº¡n Ä‘áº¿n thÄƒm nhÃ  mÃ¡y cá»§a chÃºng tÃ´i vÃ o tuáº§n tá»›i.", emoji: "ğŸ­" },
            { en: "I bought lace curtains for my bedroom window.", vi: "TÃ´i Ä‘Ã£ mua rÃ¨m ren cho cá»­a sá»• phÃ²ng ngá»§ cá»§a tÃ´i.", emoji: "ğŸªŸ" },
            { en: "When I met them in the streets yesterday, they were going to the cinema.", vi: "Khi tÃ´i gáº·p há» trÃªn phá»‘ hÃ´m qua, há» Ä‘ang Ä‘i xem phim.", emoji: "ğŸ¬" },
            { en: "Lying on the sofa, you can turn on or turn off your TV by using the remote control.", vi: "Náº±m trÃªn gháº¿ sofa, báº¡n cÃ³ thá»ƒ báº­t hoáº·c táº¯t TV báº±ng Ä‘iá»u khiá»ƒn tá»« xa.", emoji: "ğŸ“º" },
            { en: "The victim was given first-aid before he was taken to hospital.", vi: "Náº¡n nhÃ¢n Ä‘Æ°á»£c sÆ¡ cá»©u trÆ°á»›c khi Ä‘Æ°á»£c Ä‘Æ°a Ä‘áº¿n bá»‡nh viá»‡n.", emoji: "ğŸš‘" },
            { en: "The students were talking noisily when the teacher came in.", vi: "CÃ¡c há»c sinh Ä‘ang nÃ³i chuyá»‡n á»“n Ã o khi giÃ¡o viÃªn bÆ°á»›c vÃ o.", emoji: "ğŸ—£ï¸" },
            { en: "The footballer scored six goals, so his team won the game.", vi: "Cáº§u thá»§ ghi sÃ¡u bÃ n, vÃ¬ váº­y Ä‘á»™i cá»§a cáº­u áº¥y Ä‘Ã£ tháº¯ng tráº­n Ä‘áº¥u.", emoji: "âš½" },
            { en: "To obtain the best result, mix the powder with warm water.", vi: "Äá»ƒ cÃ³ Ä‘Æ°á»£c káº¿t quáº£ tá»‘t nháº¥t, hÃ£y trá»™n bá»™t vá»›i nÆ°á»›c áº¥m.", emoji: "ğŸ§ª" },
            { en: "\"Buy\" is an irregular verb. It changes into \"bought\" in the past form.", vi: "\"Buy\" lÃ  má»™t Ä‘á»™ng tá»« báº¥t quy táº¯c. NÃ³ chuyá»ƒn thÃ nh \"bought\" á»Ÿ dáº¡ng quÃ¡ khá»©.", emoji: "ğŸ“–" },
            { en: "Jane and Jack stood in front of the mirror and looked at themselves.", vi: "Jane vÃ  Jack Ä‘á»©ng trÆ°á»›c gÆ°Æ¡ng vÃ  nhÃ¬n vÃ o chÃ­nh mÃ¬nh.", emoji: "ğŸª" },
            { en: "After the flood, people in this province have to face up to famine.", vi: "Sau lÅ© lá»¥t, ngÆ°á»i dÃ¢n trong tá»‰nh nÃ y pháº£i Ä‘á»‘i máº·t vá»›i náº¡n Ä‘Ã³i.", emoji: "ğŸ˜”" },
            { en: "They work hard so that they might be well prepared for the examination.", vi: "Há» lÃ m viá»‡c chÄƒm chá»‰ Ä‘á»ƒ cÃ³ thá»ƒ chuáº©n bá»‹ tá»‘t cho ká»³ thi.", emoji: "ğŸ“š" },
            { en: "The car alarm woke me up at 6:00 yesterday morning.", vi: "ChuÃ´ng bÃ¡o Ä‘á»™ng xe Ä‘Ã£ Ä‘Ã¡nh thá»©c tÃ´i dáº­y lÃºc 6 giá» sÃ¡ng hÃ´m qua.", emoji: "â°" },
            { en: "Mary is interested in marine life so she's visiting the oceanic institute in Nha Trang.", vi: "Mary quan tÃ¢m Ä‘áº¿n sinh váº­t biá»ƒn nÃªn cÃ´ áº¥y Ä‘ang Ä‘áº¿n thÄƒm viá»‡n háº£i dÆ°Æ¡ng há»c á»Ÿ Nha Trang.", emoji: "ğŸ " },
            { en: "It took the old woman an hour to walk to the provision shop and return.", vi: "NgÆ°á»i phá»¥ ná»¯ lá»›n tuá»•i máº¥t má»™t giá» Ä‘á»ƒ Ä‘i bá»™ Ä‘áº¿n cá»­a hÃ ng táº¡p hÃ³a vÃ  trá»Ÿ vá».", emoji: "ğŸ‘µ" },
            { en: "The 20th century is considered to be the century of inventions with TV, computer and more.", vi: "Tháº¿ ká»· 20 Ä‘Æ°á»£c coi lÃ  tháº¿ ká»· cá»§a nhá»¯ng phÃ¡t minh vá»›i TV, mÃ¡y tÃ­nh vÃ  hÆ¡n tháº¿ ná»¯a.", emoji: "ğŸ’¡" },
            { en: "The factory workers work from seven in the morning until five in the afternoon.", vi: "CÃ´ng nhÃ¢n nhÃ  mÃ¡y lÃ m viá»‡c tá»« báº£y giá» sÃ¡ng Ä‘áº¿n nÄƒm giá» chiá»u.", emoji: "ğŸ­" },
            { en: "The storm prevented the climbers from continuing their adventure.", vi: "CÆ¡n bÃ£o Ä‘Ã£ ngÄƒn cáº£n nhá»¯ng ngÆ°á»i leo nÃºi tiáº¿p tá»¥c cuá»™c phiÃªu lÆ°u cá»§a há».", emoji: "â›ˆï¸" },
            { en: "Before accepting your job offer, can you tell me some more about the company?", vi: "TrÆ°á»›c khi cháº¥p nháº­n lá»i má»i lÃ m viá»‡c cá»§a báº¡n, báº¡n cÃ³ thá»ƒ cho tÃ´i biáº¿t thÃªm vá» cÃ´ng ty khÃ´ng?", emoji: "ğŸ¢" },
            { en: "We saw a lot of women planting rice in the rice fields.", vi: "ChÃºng tÃ´i Ä‘Ã£ tháº¥y ráº¥t nhiá»u phá»¥ ná»¯ Ä‘ang cáº¥y lÃºa trÃªn cÃ¡nh Ä‘á»“ng.", emoji: "ğŸŒ¾" },
            { en: "Unfortunately, our flight was delayed for 2 hours, so we were late for the last train.", vi: "Tháº­t khÃ´ng may, chuyáº¿n bay cá»§a chÃºng tÃ´i bá»‹ hoÃ£n 2 giá», vÃ¬ váº­y chÃºng tÃ´i Ä‘Ã£ bá»‹ trá»… chuyáº¿n tÃ u cuá»‘i cÃ¹ng.", emoji: " delayed" },
            { en: "What a nuisance! I hope we won't meet him again.", vi: "Tháº­t lÃ  phiá»n phá»©c! TÃ´i hy vá»ng chÃºng ta sáº½ khÃ´ng gáº·p láº¡i cáº­u ta.", emoji: "ğŸ˜¡" },
            { en: "What do many people say about Venice?", vi: "Nhiá»u ngÆ°á»i nÃ³i gÃ¬ vá» Venice?", emoji: "ğŸ‡®ğŸ‡¹" },
            { en: "When I entered his house, he was cooking.", vi: "Khi tÃ´i bÆ°á»›c vÃ o nhÃ  cáº­u áº¥y, cáº­u áº¥y Ä‘ang náº¥u Äƒn.", emoji: "ğŸ³" },
            { en: "They spent a lot of money on food and clothes.", vi: "Há» Ä‘Ã£ chi ráº¥t nhiá»u tiá»n cho thá»©c Äƒn vÃ  quáº§n Ã¡o.", emoji: "ğŸ’¸" },
            { en: "How can we remember all these vocabulary items?", vi: "LÃ m tháº¿ nÃ o chÃºng ta cÃ³ thá»ƒ nhá»› háº¿t nhá»¯ng tá»« vá»±ng nÃ y?", emoji: "ğŸ§ " },
            { en: "I wonder if he will ever return home after going to Paris.", vi: "TÃ´i tá»± há»i liá»‡u cáº­u áº¥y cÃ³ bao giá» trá»Ÿ vá» nhÃ  sau khi Ä‘áº¿n Paris khÃ´ng.", emoji: "ğŸ¤”" },
            { en: "The Panama Canal is in South America.", vi: "KÃªnh Ä‘Ã o Panama náº±m á»Ÿ Nam Má»¹.", emoji: "ğŸŒ" },
            { en: "My grandmother is very religious. She goes to pagoda every week.", vi: "BÃ  tÃ´i ráº¥t sÃ¹ng Ä‘áº¡o. BÃ  Ä‘i chÃ¹a má»—i tuáº§n.", emoji: "ğŸ‘µ" },
            { en: "The company will invest 2 million dollars to modernize its factories.", vi: "CÃ´ng ty sáº½ Ä‘áº§u tÆ° 2 triá»‡u Ä‘Ã´ la Ä‘á»ƒ hiá»‡n Ä‘áº¡i hÃ³a cÃ¡c nhÃ  mÃ¡y cá»§a mÃ¬nh.", emoji: "ğŸ­" },
            { en: "It is better for schoolgirls to wear trousers and blouses at school.", vi: "Ná»¯ sinh nÃªn máº·c quáº§n dÃ i vÃ  Ã¡o cÃ¡nh khi á»Ÿ trÆ°á»ng sáº½ tá»‘t hÆ¡n.", emoji: "ğŸ«" },
            { en: "The boss told him to get out of the room.", vi: "Ã”ng chá»§ báº£o cáº­u áº¥y ra khá»i phÃ²ng.", emoji: "ğŸšª" },
            { en: "The cold \"cures\" don't cure a cold, but they relieve the symptoms.", vi: "CÃ¡c loáº¡i thuá»‘c \"chá»¯a\" cáº£m láº¡nh khÃ´ng chá»¯a khá»i cáº£m láº¡nh, nhÆ°ng chÃºng lÃ m giáº£m cÃ¡c triá»‡u chá»©ng.", emoji: "ğŸ’Š" },
            { en: "Add sugar, water and flour to the beaten eggs and stir the mixture well.", vi: "ThÃªm Ä‘Æ°á»ng, nÆ°á»›c vÃ  bá»™t vÃ o trá»©ng Ä‘Ã£ Ä‘Ã¡nh vÃ  khuáº¥y Ä‘á»u há»—n há»£p.", emoji: "ğŸ¥š" },
            { en: "Where did neighbours gather after dinner?", vi: "HÃ ng xÃ³m Ä‘Ã£ tá»¥ táº­p á»Ÿ Ä‘Ã¢u sau bá»¯a tá»‘i?", emoji: "ğŸ˜ï¸" },
            { en: "How often do your parents go camping?", vi: "Bá»‘ máº¹ báº¡n Ä‘i cáº¯m tráº¡i bao lÃ¢u má»™t láº§n?", emoji: "ğŸ•ï¸" },
            { en: "My little daughter is looking at herself in the mirror.", vi: "Con gÃ¡i nhá» cá»§a tÃ´i Ä‘ang nhÃ¬n vÃ o gÆ°Æ¡ng.", emoji: "ğŸª" },
            { en: "About 60% of the world's radio stations broadcast in English.", vi: "Khoáº£ng 60% Ä‘Ã i phÃ¡t thanh trÃªn tháº¿ giá»›i phÃ¡t sÃ³ng báº±ng tiáº¿ng Anh.", emoji: "ğŸ“»" },
            { en: "I always drive past the post office on my way to work.", vi: "TÃ´i luÃ´n lÃ¡i xe qua bÆ°u Ä‘iá»‡n trÃªn Ä‘Æ°á»ng Ä‘i lÃ m.", emoji: "ğŸ“®" },
            { en: "I asked if she could speak English.", vi: "TÃ´i há»i cÃ´ áº¥y cÃ³ thá»ƒ nÃ³i tiáº¿ng Anh khÃ´ng.", emoji: "ğŸ’¬" },
            { en: "By learning English, you can get access to the world's development.", vi: "Báº±ng cÃ¡ch há»c tiáº¿ng Anh, báº¡n cÃ³ thá»ƒ tiáº¿p cáº­n vá»›i sá»± phÃ¡t triá»ƒn cá»§a tháº¿ giá»›i.", emoji: "ğŸŒ" },
            { en: "He always avoids meeting me.", vi: "Cáº­u áº¥y luÃ´n trÃ¡nh gáº·p tÃ´i.", emoji: "âŒ" },
            { en: "We sometimes send our relatives or friends greeting cards on special occasions.", vi: "ChÃºng tÃ´i thá»‰nh thoáº£ng gá»­i thiá»‡p chÃºc má»«ng cho ngÆ°á»i thÃ¢n hoáº·c báº¡n bÃ¨ vÃ o nhá»¯ng dá»‹p Ä‘áº·c biá»‡t.", emoji: "âœ‰ï¸" },
            { en: "Binh and I didn't go anywhere last weekend.", vi: "BÃ¬nh vÃ  tÃ´i Ä‘Ã£ khÃ´ng Ä‘i Ä‘Ã¢u vÃ o cuá»‘i tuáº§n trÆ°á»›c.", emoji: "ğŸ " },
            { en: "I have been staying in England for a few weeks now.", vi: "TÃ´i Ä‘Ã£ á»Ÿ Anh Ä‘Æ°á»£c vÃ i tuáº§n rá»“i.", emoji: "ğŸ‡¬ğŸ‡§" },
            { en: "It was difficult to arrange a day which was convenient for everyone.", vi: "Tháº­t khÃ³ Ä‘á»ƒ sáº¯p xáº¿p má»™t ngÃ y thuáº­n tiá»‡n cho má»i ngÆ°á»i.", emoji: "ğŸ“…" },
            { en: "The new radio didn't work, so he took it back to the shop.", vi: "ÄÃ i phÃ¡t thanh má»›i khÃ´ng hoáº¡t Ä‘á»™ng, vÃ¬ váº­y cáº­u áº¥y Ä‘Ã£ mang nÃ³ trá»Ÿ láº¡i cá»­a hÃ ng.", emoji: "ğŸ“»" },
            { en: "There was so little sugar that I decided not to make a cake.", vi: "CÃ³ quÃ¡ Ã­t Ä‘Æ°á»ng nÃªn tÃ´i quyáº¿t Ä‘á»‹nh khÃ´ng lÃ m bÃ¡nh.", emoji: "ğŸ°" },
            { en: "I ran out of the room when the phone rang.", vi: "TÃ´i cháº¡y ra khá»i phÃ²ng khi Ä‘iá»‡n thoáº¡i reo.", emoji: "ğŸ“" },
            { en: "These spoons are made from metal.", vi: "Nhá»¯ng chiáº¿c thÃ¬a nÃ y Ä‘Æ°á»£c lÃ m tá»« kim loáº¡i.", emoji: "ğŸ¥„" },
            { en: "Dead leaves fall to the ground and decompose very quickly in wet weather.", vi: "LÃ¡ cÃ¢y rá»¥ng xuá»‘ng Ä‘áº¥t vÃ  phÃ¢n há»§y ráº¥t nhanh trong thá»i tiáº¿t áº©m Æ°á»›t.", emoji: "ğŸ‚" },
            { en: "Don't talk like that to me!", vi: "Äá»«ng nÃ³i chuyá»‡n nhÆ° váº­y vá»›i tÃ´i!", emoji: "ğŸ˜ " },
            { en: "Here is the photo of my family and let me tell you about us.", vi: "ÄÃ¢y lÃ  bá»©c áº£nh gia Ä‘Ã¬nh tÃ´i vÃ  Ä‘á»ƒ tÃ´i ká»ƒ cho báº¡n nghe vá» chÃºng tÃ´i.", emoji: "ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦" },
            { en: "The doctor advised Robert to drink more fresh water.", vi: "BÃ¡c sÄ© khuyÃªn Robert nÃªn uá»‘ng nhiá»u nÆ°á»›c lá»c hÆ¡n.", emoji: "ğŸ’§" },
        ],
        "Chá»§ Ä‘á» 3: NÃ¢ng cao": [
            { en: "Sooner or later a satellite will be destroyed by a large piece of rubbish.", vi: "Sá»›m hay muá»™n má»™t vá»‡ tinh sáº½ bá»‹ phÃ¡ há»§y bá»Ÿi má»™t máº£nh rÃ¡c lá»›n.", emoji: "ğŸ—‘ï¸" },
            { en: "The children are playing happily in the schoolyard.", vi: "Tráº» em Ä‘ang chÆ¡i Ä‘Ã¹a vui váº» trong sÃ¢n trÆ°á»ng.", emoji: "ğŸ¤¸" },
            { en: "What does your grandfather do on his farm?", vi: "Ã”ng cá»§a báº¡n lÃ m gÃ¬ trÃªn nÃ´ng tráº¡i cá»§a Ã´ng áº¥y?", emoji: "ğŸ§‘â€ğŸŒ¾" },
            { en: "There aren't any buses in the streets because the drivers have gone on strike.", vi: "KhÃ´ng cÃ³ xe buÃ½t nÃ o trÃªn Ä‘Æ°á»ng phá»‘ vÃ¬ cÃ¡c tÃ i xáº¿ Ä‘Ã£ Ä‘Ã¬nh cÃ´ng.", emoji: "ğŸšŒ" },
            { en: "Jack told me that he was enjoying his new class.", vi: "Jack nÃ³i vá»›i tÃ´i ráº±ng cáº­u áº¥y Ä‘ang thÃ­ch thÃº lá»›p há»c má»›i cá»§a mÃ¬nh.", emoji: "ğŸ˜Š" },
            { en: "The teacher was ill last week.", vi: "GiÃ¡o viÃªn bá»‹ á»‘m vÃ o tuáº§n trÆ°á»›c.", emoji: "ğŸ¤’" },
            { en: "Is Facebook a dangerous addiction or just harmless fun?", vi: "Facebook lÃ  má»™t cÆ¡n nghiá»‡n nguy hiá»ƒm hay chá»‰ lÃ  niá»m vui vÃ´ háº¡i?", emoji: "ğŸ“±" },
            { en: "We use chalk to write things on the blackboard.", vi: "ChÃºng tÃ´i sá»­ dá»¥ng pháº¥n Ä‘á»ƒ viáº¿t má»i thá»© trÃªn báº£ng Ä‘en.", emoji: "ì¹ íŒ" },
            { en: "If the work is finished by lunchtime, you can go home.", vi: "Náº¿u cÃ´ng viá»‡c Ä‘Æ°á»£c hoÃ n thÃ nh trÆ°á»›c giá» Äƒn trÆ°a, báº¡n cÃ³ thá»ƒ vá» nhÃ .", emoji: "ğŸ¡" },
            { en: "It was very uncomfortable to sit in one place for so long.", vi: "Tháº­t ráº¥t khÃ³ chá»‹u khi ngá»“i á»Ÿ má»™t chá»— quÃ¡ lÃ¢u.", emoji: "ğŸ˜«" },
            { en: "Sorry, I am late because I got stuck in the traffic jam.", vi: "Xin lá»—i, tÃ´i bá»‹ trá»… vÃ¬ káº¹t xe.", emoji: "ğŸš¦" },
            { en: "Mr. James was painting a picture when I came to meet him.", vi: "Ã”ng James Ä‘ang váº½ má»™t bá»©c tranh khi tÃ´i Ä‘áº¿n gáº·p Ã´ng áº¥y.", emoji: "ğŸ¨" },
            { en: "She is flying to Hanoi next Monday.", vi: "CÃ´ áº¥y sáº½ bay Ä‘áº¿n HÃ  Ná»™i vÃ o thá»© Hai tá»›i.", emoji: "âœˆï¸" },
            { en: "His mother asked him to tidy up his room as it was dirty.", vi: "Máº¹ cáº­u áº¥y báº£o cáº­u áº¥y dá»n dáº¹p phÃ²ng vÃ¬ nÃ³ báº©n.", emoji: "ğŸ§¹" },
            { en: "They are going to see the temple tomorrow. \"See\" here means visit.", vi: "Há» sáº½ Ä‘i thÄƒm Ä‘á»n vÃ o ngÃ y mai. \"See\" á»Ÿ Ä‘Ã¢y cÃ³ nghÄ©a lÃ  thÄƒm.", emoji: "ğŸ¯" },
            { en: "He has written four novels so far.", vi: "Cho Ä‘áº¿n nay cáº­u áº¥y Ä‘Ã£ viáº¿t bá»‘n cuá»‘n tiá»ƒu thuyáº¿t.", emoji: "ğŸ“–" },
            { en: "Remember to wear your warm clothes when it's cold.", vi: "HÃ£y nhá»› máº·c quáº§n Ã¡o áº¥m khi trá»i láº¡nh.", emoji: "ğŸ§£" },
            { en: "It'll only take me a few minutes and I'll be back very soon.", vi: "TÃ´i chá»‰ máº¥t vÃ i phÃºt vÃ  tÃ´i sáº½ quay láº¡i ráº¥t nhanh.", emoji: "â°" },
            { en: "At last, after trying three times, he passed the examination.", vi: "Cuá»‘i cÃ¹ng, sau khi cá»‘ gáº¯ng ba láº§n, cáº­u áº¥y Ä‘Ã£ vÆ°á»£t qua ká»³ thi.", emoji: "âœ…" },
            { en: "You ought to report to the police if you see a robbery.", vi: "Báº¡n nÃªn bÃ¡o cáº£nh sÃ¡t náº¿u tháº¥y má»™t vá»¥ cÆ°á»›p.", emoji: "ğŸš¨" },
            { en: "There was a scary big storm on Christmas Day.", vi: "CÃ³ má»™t cÆ¡n bÃ£o lá»›n Ä‘Ã¡ng sá»£ vÃ o ngÃ y GiÃ¡ng sinh.", emoji: "â›ˆï¸" },
            { en: "Her good diet keeps her healthy.", vi: "Cháº¿ Ä‘á»™ Äƒn uá»‘ng tá»‘t cá»§a cÃ´ áº¥y giÃºp cÃ´ áº¥y khá»e máº¡nh.", emoji: "ğŸ¥—" },
            { en: "The cat is lying leisurely in the morning sunshine.", vi: "Con mÃ¨o Ä‘ang náº±m thÆ° giÃ£n trong Ã¡nh náº¯ng buá»•i sÃ¡ng.", emoji: "ğŸˆ" },
            { en: "Over 50000 people in Ethiopia have died of starvation in the past month.", vi: "HÆ¡n 50000 ngÆ°á»i á»Ÿ Ethiopia Ä‘Ã£ cháº¿t vÃ¬ Ä‘Ã³i trong thÃ¡ng qua.", emoji: "ğŸ˜”" },
            { en: "I arrived home at ten fifteen last night.", vi: "TÃ´i vá» nhÃ  lÃºc mÆ°á»i giá» mÆ°á»i lÄƒm tá»‘i qua.", emoji: "ğŸ " },
            { en: "He failed the examination. He didn't study hard enough.", vi: "Cáº­u áº¥y Ä‘Ã£ trÆ°á»£t ká»³ thi. Cáº­u áº¥y Ä‘Ã£ khÃ´ng há»c Ä‘á»§ chÄƒm chá»‰.", emoji: "âŒ" },
            { en: "My car was repaired yesterday.", vi: "Ã” tÃ´ cá»§a tÃ´i Ä‘Ã£ Ä‘Æ°á»£c sá»­a chá»¯a hÃ´m qua.", emoji: "ğŸ› ï¸" },
            { en: "All the subjects were taught by one teacher.", vi: "Táº¥t cáº£ cÃ¡c mÃ´n há»c Ä‘á»u Ä‘Æ°á»£c dáº¡y bá»Ÿi má»™t giÃ¡o viÃªn.", emoji: "ğŸ§‘â€ğŸ«" },
            { en: "This is the first time I have visited a famous place in Hanoi.", vi: "ÄÃ¢y lÃ  láº§n Ä‘áº§u tiÃªn tÃ´i Ä‘áº¿n thÄƒm má»™t Ä‘á»‹a Ä‘iá»ƒm ná»•i tiáº¿ng á»Ÿ HÃ  Ná»™i.", emoji: "ğŸ‡»ğŸ‡³" },
            { en: "Nobody wants to work with him because he is always neglecting his duties.", vi: "KhÃ´ng ai muá»‘n lÃ m viá»‡c vá»›i cáº­u áº¥y vÃ¬ cáº­u áº¥y luÃ´n sao nhÃ£ng nhiá»‡m vá»¥ cá»§a mÃ¬nh.", emoji: "ğŸš«" },
            { en: "Your sister likes watching detective films, doesn't she?", vi: "Chá»‹ (em) gÃ¡i báº¡n thÃ­ch xem phim trinh thÃ¡m, pháº£i khÃ´ng?", emoji: "ğŸ•µï¸" },
            { en: "The film was not interesting enough for me to watch.", vi: "Bá»™ phim khÃ´ng Ä‘á»§ thÃº vá»‹ Ä‘á»ƒ tÃ´i xem.", emoji: " boring" },
            { en: "My grandmother prefers wearing the traditional clothing to the modern clothing.", vi: "BÃ  tÃ´i thÃ­ch máº·c trang phá»¥c truyá»n thá»‘ng hÆ¡n trang phá»¥c hiá»‡n Ä‘áº¡i.", emoji: "ğŸ‘˜" },
            { en: "By whom was this story written?", vi: "CÃ¢u chuyá»‡n nÃ y Ä‘Æ°á»£c viáº¿t bá»Ÿi ai?", emoji: "â“" },
            { en: "I went out with some friends on Saturday.", vi: "TÃ´i Ä‘Ã£ Ä‘i chÆ¡i vá»›i má»™t vÃ i ngÆ°á»i báº¡n vÃ o thá»© Báº£y.", emoji: "ğŸ‘¯" },
            { en: "If I were you, I would call and apologize.", vi: "Náº¿u tÃ´i lÃ  báº¡n, tÃ´i sáº½ gá»i Ä‘iá»‡n vÃ  xin lá»—i.", emoji: "ğŸ“" },
            { en: "She went to market without buying anything.", vi: "CÃ´ áº¥y Ä‘i chá»£ mÃ  khÃ´ng mua báº¥t cá»© thá»© gÃ¬.", emoji: "ğŸ›’" },
            { en: "Someone is knocking at the door.", vi: "Ai Ä‘Ã³ Ä‘ang gÃµ cá»­a.", emoji: "Knocking door" },
            { en: "I need a hair dresser. I haven't been to the barber's recently.", vi: "TÃ´i cáº§n má»™t thá»£ lÃ m tÃ³c. Gáº§n Ä‘Ã¢y tÃ´i chÆ°a Ä‘áº¿n tiá»‡m cáº¯t tÃ³c.", emoji: "ğŸ’‡" },
            { en: "Sharp knives are actually safer to use than dull ones.", vi: "Dao sáº¯c thá»±c sá»± an toÃ n hÆ¡n dao cÃ¹n khi sá»­ dá»¥ng.", emoji: "ğŸ”ª" },
            { en: "Don't you believe in equality between men and women?", vi: "Báº¡n khÃ´ng tin vÃ o sá»± bÃ¬nh Ä‘áº³ng giá»¯a nam vÃ  ná»¯ sao?", emoji: "âš–ï¸" },
            { en: "In the world, tons of used papers are thrown away everyday.", vi: "TrÃªn tháº¿ giá»›i, hÃ ng táº¥n giáº¥y Ä‘Ã£ qua sá»­ dá»¥ng bá»‹ vá»©t Ä‘i má»—i ngÃ y.", emoji: "ğŸ—‘ï¸" },
            { en: "As a sensible man, Henry always looks calm and makes a wise decision.", vi: "LÃ  má»™t ngÆ°á»i Ä‘Ã n Ã´ng nháº¡y bÃ©n, Henry luÃ´n trÃ´ng Ä‘iá»m tÄ©nh vÃ  Ä‘Æ°a ra quyáº¿t Ä‘á»‹nh khÃ´n ngoan.", emoji: "ğŸ§ " },
            { en: "In industry, most glass is manufactured.", vi: "Trong cÃ´ng nghiá»‡p, háº§u háº¿t thá»§y tinh Ä‘Æ°á»£c sáº£n xuáº¥t.", emoji: "ğŸ§ª" },
            { en: "It's very kind of you to help me.", vi: "Báº¡n tháº­t tá»‘t bá»¥ng khi giÃºp tÃ´i.", emoji: "ğŸ˜Š" },
            { en: "Hyde Park is a very large park in central London.", vi: "Hyde Park lÃ  má»™t cÃ´ng viÃªn ráº¥t lá»›n á»Ÿ trung tÃ¢m London.", emoji: "ğŸŒ³" },
            { en: "He wants to design a mobile app that makes education fun and easy.", vi: "Cáº­u áº¥y muá»‘n thiáº¿t káº¿ má»™t á»©ng dá»¥ng di Ä‘á»™ng lÃ m cho viá»‡c há»c trá»Ÿ nÃªn thÃº vá»‹ vÃ  dá»… dÃ ng.", emoji: "ğŸ“±" },
            { en: "Medical facilities are more easily accessible than ever before.", vi: "CÃ¡c cÆ¡ sá»Ÿ y táº¿ dá»… tiáº¿p cáº­n hÆ¡n bao giá» háº¿t.", emoji: "ğŸ¥" },
            { en: "Our teacher asked us what we were most worried about.", vi: "GiÃ¡o viÃªn cá»§a chÃºng tÃ´i há»i chÃºng tÃ´i lo láº¯ng nháº¥t vá» Ä‘iá»u gÃ¬.", emoji: "â“" },
            { en: "Mai broke the glass because of her carelessness.", vi: "Mai lÃ m vá»¡ ly vÃ¬ sá»± báº¥t cáº©n cá»§a cÃ´ áº¥y.", emoji: "ğŸ˜”" },
            { en: "Bill Gates is a very important person in the computer industry.", vi: "Bill Gates lÃ  má»™t ngÆ°á»i ráº¥t quan trá»ng trong ngÃ nh cÃ´ng nghiá»‡p mÃ¡y tÃ­nh.", emoji: "ğŸ’»" },
            { en: "Our environment is becoming more and more polluted.", vi: "MÃ´i trÆ°á»ng cá»§a chÃºng ta Ä‘ang ngÃ y cÃ ng Ã´ nhiá»…m.", emoji: " polluting" },
            { en: "Yellowstone is the United States' most famous national park.", vi: "Yellowstone lÃ  cÃ´ng viÃªn quá»‘c gia ná»•i tiáº¿ng nháº¥t cá»§a Hoa Ká»³.", emoji: "ğŸï¸" },
            { en: "Columbus discovered America in the 15th century.", vi: "Columbus Ä‘Ã£ khÃ¡m phÃ¡ ra ChÃ¢u Má»¹ vÃ o tháº¿ ká»· 15.", emoji: "ğŸ§­" },
            { en: "Read the user's manual carefully. It will give you a lot of useful information.", vi: "Äá»c ká»¹ hÆ°á»›ng dáº«n sá»­ dá»¥ng. NÃ³ sáº½ cung cáº¥p cho báº¡n nhiá»u thÃ´ng tin há»¯u Ã­ch.", emoji: "ğŸ“–" },
            { en: "There are only a few hotels in the city so it's hard to find accommodation during the high season.", vi: "Chá»‰ cÃ³ má»™t vÃ i khÃ¡ch sáº¡n trong thÃ nh phá»‘ nÃªn ráº¥t khÃ³ tÃ¬m chá»— á»Ÿ trong mÃ¹a cao Ä‘iá»ƒm.", emoji: "ğŸ¨" },
            { en: "Having the common cold is very unpleasant.", vi: "Bá»‹ cáº£m láº¡nh thÃ´ng thÆ°á»ng lÃ  ráº¥t khÃ³ chá»‹u.", emoji: "ğŸ¤§" },
            { en: "When the clock strikes 6 a.m., my new day begins again.", vi: "Khi Ä‘á»“ng há»“ Ä‘iá»ƒm 6 giá» sÃ¡ng, ngÃ y má»›i cá»§a tÃ´i báº¯t Ä‘áº§u láº¡i.", emoji: "â°" },
            { en: "We can look for information on recycling things in the local library.", vi: "ChÃºng ta cÃ³ thá»ƒ tÃ¬m kiáº¿m thÃ´ng tin vá» viá»‡c tÃ¡i cháº¿ má»i thá»© trong thÆ° viá»‡n Ä‘á»‹a phÆ°Æ¡ng.", emoji: "â™»ï¸" },
            { en: "It is great to be with you on such a lovely day.", vi: "Tháº­t tuyá»‡t khi Ä‘Æ°á»£c á»Ÿ bÃªn báº¡n vÃ o má»™t ngÃ y Ä‘Ã¡ng yÃªu nhÆ° váº­y.", emoji: "ğŸ˜Š" },
            { en: "The 22nd Olympic Games were held in Moscow.", vi: "Tháº¿ váº­n há»™i Olympic láº§n thá»© 22 Ä‘Æ°á»£c tá»• chá»©c táº¡i Moscow.", emoji: "ğŸ…" },
            { en: "My sister is better at cooking than I am.", vi: "Chá»‹ (em) gÃ¡i tÃ´i náº¥u Äƒn giá»i hÆ¡n tÃ´i.", emoji: "ğŸ³" },
            { en: "These kinds of flowers are beautiful enough to be exported to foreign markets.", vi: "Nhá»¯ng loáº¡i hoa nÃ y Ä‘á»§ Ä‘áº¹p Ä‘á»ƒ Ä‘Æ°á»£c xuáº¥t kháº©u ra thá»‹ trÆ°á»ng nÆ°á»›c ngoÃ i.", emoji: "ğŸŒ¸" },
            { en: "It took me a long time to get used to wearing glasses.", vi: "TÃ´i máº¥t má»™t thá»i gian dÃ i Ä‘á»ƒ quen vá»›i viá»‡c Ä‘eo kÃ­nh.", emoji: "ğŸ‘“" },
            { en: "Much of champagne is exported from France to our country this year.", vi: "Nhiá»u rÆ°á»£u champagne Ä‘Æ°á»£c xuáº¥t kháº©u tá»« PhÃ¡p sang nÆ°á»›c chÃºng tÃ´i trong nÄƒm nay.", emoji: "ğŸ¥‚" },
            { en: "She used to be fond of pop music but has now lost interest in it.", vi: "CÃ´ áº¥y tá»«ng thÃ­ch nháº¡c pop nhÆ°ng giá» Ä‘Ã£ máº¥t há»©ng thÃº.", emoji: "ğŸ¶" },
            { en: "The song is about a green frog.", vi: "BÃ i hÃ¡t ká»ƒ vá» má»™t con áº¿ch xanh.", emoji: "ğŸ¸" },
            { en: "We flew over the volcano and saw lava was pouring out.", vi: "ChÃºng tÃ´i bay qua nÃºi lá»­a vÃ  tháº¥y dung nham Ä‘ang phun trÃ o.", emoji: "ğŸŒ‹" },
            { en: "Nam often makes other people laugh because he likes telling jokes.", vi: "Nam thÆ°á»ng lÃ m ngÆ°á»i khÃ¡c cÆ°á»i vÃ¬ cáº­u áº¥y thÃ­ch ká»ƒ chuyá»‡n cÆ°á»i.", emoji: "ğŸ˜‚" },
            { en: "He was so tired that he went to bed early.", vi: "Cáº­u áº¥y quÃ¡ má»‡t nÃªn Ä‘i ngá»§ sá»›m.", emoji: "ğŸ˜´" },
            { en: "The weather forecast said it would rain heavily the following day.", vi: "Dá»± bÃ¡o thá»i tiáº¿t nÃ³i ráº±ng trá»i sáº½ mÆ°a to vÃ o ngÃ y hÃ´m sau.", emoji: "ğŸŒ§ï¸" },
            { en: "He is going to catch a bus to the Imperial Citadel of Thang Long next Sunday.", vi: "Cáº­u áº¥y sáº½ báº¯t xe buÃ½t Ä‘áº¿n HoÃ ng thÃ nh ThÄƒng Long vÃ o Chá»§ nháº­t tá»›i.", emoji: "ğŸšŒ" },
            { en: "I'm not sure, but as far as I know he will stay at home on holiday.", vi: "TÃ´i khÃ´ng cháº¯c, nhÆ°ng theo tÃ´i biáº¿t cáº­u áº¥y sáº½ á»Ÿ nhÃ  vÃ o ngÃ y nghá»‰.", emoji: "ğŸ " },
            { en: "My father doesn't smoke cigarettes any more. He gave it up five years ago.", vi: "Bá»‘ tÃ´i khÃ´ng hÃºt thuá»‘c lÃ¡ ná»¯a. Ã”ng áº¥y Ä‘Ã£ bá» thuá»‘c nÄƒm nÄƒm trÆ°á»›c.", emoji: "ğŸš­" },
            { en: "Your application must be typed in 3 copies to hand in to our company.", vi: "ÄÆ¡n Ä‘Äƒng kÃ½ cá»§a báº¡n pháº£i Ä‘Æ°á»£c Ä‘Ã¡nh mÃ¡y thÃ nh 3 báº£n Ä‘á»ƒ ná»™p cho cÃ´ng ty chÃºng tÃ´i.", emoji: "ğŸ“„" },
            { en: "He used to drive more carefully than he does now.", vi: "Cáº­u áº¥y Ä‘Ã£ tá»«ng lÃ¡i xe cáº©n tháº­n hÆ¡n bÃ¢y giá».", emoji: "ğŸš—" },
            { en: "We arrived on time although the traffic was bad.", vi: "ChÃºng tÃ´i Ä‘Ã£ Ä‘áº¿n Ä‘Ãºng giá» máº·c dÃ¹ giao thÃ´ng tá»‡.", emoji: "â±ï¸" },
            { en: "The professor gave an interesting talk on the global climates.", vi: "GiÃ¡o sÆ° Ä‘Ã£ cÃ³ má»™t bÃ i nÃ³i chuyá»‡n thÃº vá»‹ vá» khÃ­ háº­u toÃ n cáº§u.", emoji: "ğŸ—£ï¸" },
            { en: "John should go to Nha Rong Harbor because it is the place where President Ho Chi Minh left Vietnam in 1911.", vi: "John nÃªn Ä‘áº¿n Báº¿n NhÃ  Rá»“ng vÃ¬ Ä‘Ã³ lÃ  nÆ¡i Chá»§ tá»‹ch Há»“ ChÃ­ Minh rá»i Viá»‡t Nam vÃ o nÄƒm 1911.", emoji: "ğŸ‡»ğŸ‡³" },
            { en: "The Amazon is one of the longest rivers in the world.", vi: "SÃ´ng Amazon lÃ  má»™t trong nhá»¯ng con sÃ´ng dÃ i nháº¥t tháº¿ giá»›i.", emoji: "ğŸ—ºï¸" },
            { en: "In Vietnam, there are more and more families having cable TV.", vi: "á» Viá»‡t Nam, ngÃ y cÃ ng cÃ³ nhiá»u gia Ä‘Ã¬nh cÃ³ truyá»n hÃ¬nh cÃ¡p.", emoji: "ğŸ“º" },
            { en: "The victim shouldn't drink any wine when he/she has a shock.", vi: "Náº¡n nhÃ¢n khÃ´ng nÃªn uá»‘ng rÆ°á»£u khi bá»‹ sá»‘c.", emoji: "ğŸ·" },
            { en: "Ricky is looking up the gas station on the mobile phone.", vi: "Ricky Ä‘ang tÃ¬m tráº¡m xÄƒng trÃªn Ä‘iá»‡n thoáº¡i di Ä‘á»™ng.", emoji: "â›½" },
            { en: "It took the old woman an hour to walk around the lake yesterday.", vi: "NgÆ°á»i phá»¥ ná»¯ lá»›n tuá»•i máº¥t má»™t giá» Ä‘á»ƒ Ä‘i bá»™ quanh há»“ hÃ´m qua.", emoji: "ğŸ‘µ" },
            { en: "The sea and rivers are too dirty to swim in.", vi: "Biá»ƒn vÃ  sÃ´ng quÃ¡ báº©n Ä‘á»ƒ bÆ¡i.", emoji: "ğŸŒŠ" },
            { en: "Lucy got dressed quickly and went for work.", vi: "Lucy thay Ä‘á»“ nhanh chÃ³ng vÃ  Ä‘i lÃ m.", emoji: "ğŸ‘š" },
            { en: "There is a meeting between 9 am and 2 pm.", vi: "CÃ³ má»™t cuá»™c há»p tá»« 9 giá» sÃ¡ng Ä‘áº¿n 2 giá» chiá»u.", emoji: "ğŸ—“ï¸" },
            { en: "How skilfully Van Hau plays football!", vi: "VÄƒn Háº­u chÆ¡i bÃ³ng Ä‘Ã¡ khÃ©o lÃ©o lÃ m sao!", emoji: "âš½" },
            { en: "Susan was very pleased with the birthday present her father gave her.", vi: "Susan ráº¥t hÃ i lÃ²ng vá»›i mÃ³n quÃ  sinh nháº­t mÃ  bá»‘ cÃ´ áº¥y táº·ng.", emoji: "ğŸ" },
            { en: "John told Mary not to touch the wall.", vi: "John báº£o Mary Ä‘á»«ng cháº¡m vÃ o tÆ°á»ng.", emoji: "ğŸ§±" },
            { en: "I don't like pop music. My sister doesn't like it either.", vi: "TÃ´i khÃ´ng thÃ­ch nháº¡c pop. Chá»‹ (em) gÃ¡i tÃ´i cÅ©ng khÃ´ng thÃ­ch.", emoji: "ğŸ¶" },
            { en: "They have just phoned to say that they aren't coming back till Friday night.", vi: "Há» vá»«a gá»i Ä‘iá»‡n nÃ³i ráº±ng há» sáº½ khÃ´ng trá»Ÿ láº¡i cho Ä‘áº¿n tá»‘i thá»© SÃ¡u.", emoji: "ğŸ“" },
            { en: "Bowls, vases, jars, beer mugs and champagne glasses are sold in the glassware store.", vi: "BÃ¡t, lá» hoa, hÅ©, cá»‘c bia vÃ  ly champagne Ä‘Æ°á»£c bÃ¡n trong cá»­a hÃ ng Ä‘á»“ thá»§y tinh.", emoji: "ğŸ¥‚" },
            { en: "If it is kept dry, a seed can still sprout up to forty years after its formation.", vi: "Náº¿u Ä‘Æ°á»£c giá»¯ khÃ´ rÃ¡o, má»™t háº¡t giá»‘ng váº«n cÃ³ thá»ƒ náº£y máº§m tá»›i bá»‘n mÆ°Æ¡i nÄƒm sau khi hÃ¬nh thÃ nh.", emoji: "ğŸŒ±" },
            { en: "She is very gorgeous in velvet.", vi: "CÃ´ áº¥y ráº¥t lá»™ng láº«y trong chiáº¿c vÃ¡y nhung.", emoji: "ğŸ’ƒ" },
            { en: "I have to change the old car tyre. It's flat.", vi: "TÃ´i pháº£i thay lá»‘p xe cÅ©. NÃ³ bá»‹ xáº¹p rá»“i.", emoji: "ğŸš—" },
            { en: "The road to our village should be widened as soon as possible.", vi: "Con Ä‘Æ°á»ng Ä‘áº¿n lÃ ng cá»§a chÃºng tÃ´i nÃªn Ä‘Æ°á»£c má»Ÿ rá»™ng cÃ ng sá»›m cÃ ng tá»‘t.", emoji: "ğŸš§" },
            { en: "Trang: Can you lend me some money? I promise to return you soon. Thu: All right.", vi: "Trang: Báº¡n cÃ³ thá»ƒ cho tÃ´i mÆ°á»£n Ã­t tiá»n Ä‘Æ°á»£c khÃ´ng? TÃ´i há»©a sáº½ tráº£ láº¡i sá»›m. Thu: ÄÆ°á»£c thÃ´i.", emoji: "ğŸ’¸" }
        ]
    };

    const elements = {
        startScreen: document.getElementById('startScreen'),
        gameScreen: document.getElementById('gameScreen'),
        topicSelectionScreen: document.getElementById('topicSelectionScreen'),
        topicCongratsScreen: document.getElementById('topicCongratsScreen'),
        meaning: document.getElementById('meaning'),
        message: document.getElementById('message'),
        listenAgainBtn: document.getElementById('listenAgainBtn'),
        resetBtn: document.getElementById('resetBtn'),
        startBtn: document.getElementById('startBtn'),
        playTopicAgainBtn: document.getElementById('playTopicAgainBtn'),
        chooseAnotherTopicBtn: document.getElementById('chooseAnotherTopicBtn'),
        score: document.getElementById('score'),
        canvas: document.getElementById('fireworks'),
        playerNameInput: document.getElementById('playerNameInput'),
        congratsMessage: document.getElementById('congratsMessage'),
        gameSubtitle: document.getElementById('gameSubtitle'),
        answerInput: document.getElementById('answerInput'),
        checkBtn: document.getElementById('checkBtn'),
        hintBtn: document.getElementById('hintBtn'),
        hint: document.getElementById('hint'),
    };

    let state = {};
    let currentListenCount = 0; // Biáº¿n Ä‘áº¿m sá»‘ láº§n nghe
    const MAX_AUTO_LISTEN = 2; // Sá»‘ láº§n tá»± Ä‘á»™ng Ä‘á»c khi báº¯t Ä‘áº§u cÃ¢u má»›i
    const isSpeechSupported = 'speechSynthesis' in window && 'SpeechSynthesisUtterance' in window;

    function initializeState() {
        state = {
            playerName: state.playerName || '',
            currentTopic: null,
            currentSentences: [],
            originalSentence: '',
            score: 0,
            completedSentences: 0,
            correctlyAnsweredCount: 0,
            currentSentenceIndex: 0,
            isSpeaking: false,
            animationFrameId: null,
            speechTimeoutId: null,
            audioIntervalId: null,
            mistakeCount: 0,
            nextSentenceTimeoutId: null
        };
        currentListenCount = 0; // Reset count
    }

    function initializeSpeech() {
        if (isSpeechSupported && speechSynthesis.getVoices().length === 0) {
            speechSynthesis.onvoiceschanged = () => console.log("Voices loaded.");
        }
    }

    function speak(text, options = {}) {
        const callback = typeof options === 'function' ? options : options.callback;
        const rate = options.rate || 1.0;
        
        if (!isSpeechSupported) { if (callback) callback(); return; }
                
        // Stop any currently playing speech
        if (speechSynthesis.speaking) {
            speechSynthesis.cancel();
        }
        
        state.isSpeaking = true;
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'en-US';
        utterance.rate = rate;

        utterance.onend = () => {
            state.isSpeaking = false;
            state.speechTimeoutId = null;
            if (callback) callback();
        };
        
        utterance.onerror = (event) => {
            if (event.error !== 'interrupted') console.error('SpeechSynthesis Error:', event.error);
            state.isSpeaking = false;
            state.speechTimeoutId = null;
            if (callback) callback();
        };
        
        state.speechTimeoutId = setTimeout(() => {
            speechSynthesis.speak(utterance);
        }, 100);
    }

    function updateScoreDisplay() {
        elements.score.textContent = `Äiá»ƒm: ${state.score} | HoÃ n thÃ nh: ${state.completedSentences}/${state.currentSentences.length}`;
    }

    // Logic má»›i: Tá»± Ä‘á»™ng Ä‘á»c 2 láº§n khi báº¯t Ä‘áº§u cÃ¢u, sau Ä‘Ã³ chuyá»ƒn sang láº·p láº¡i báº±ng nÃºt "Nghe láº¡i"
    function startAudioLoop() {
        stopAudioLoop();
        currentListenCount = 0;
        
        const listenNext = () => {
            if (currentListenCount < MAX_AUTO_LISTEN) {
                currentListenCount++;
                speak(state.originalSentence, {
                    rate: 0.9,
                    callback: () => {
                        // Äá»£i 1 giÃ¢y giá»¯a cÃ¡c láº§n Ä‘á»c tá»± Ä‘á»™ng
                        if (currentListenCount < MAX_AUTO_LISTEN) {
                            state.audioIntervalId = setTimeout(listenNext, 1000);
                        }
                    }
                });
            }
        };
        
        listenNext();
    }

    function stopAudioLoop(cancelSpeech = true) {
        if (state.audioIntervalId) clearTimeout(state.audioIntervalId);
        if (state.speechTimeoutId) clearTimeout(state.speechTimeoutId);
        if (state.nextSentenceTimeoutId) clearTimeout(state.nextSentenceTimeoutId);
        state.audioIntervalId = null;
        state.speechTimeoutId = null;
        state.nextSentenceTimeoutId = null;
        if (cancelSpeech && isSpeechSupported && speechSynthesis.speaking) {
            speechSynthesis.cancel();
        }
    }

    function startNewSentence() {
        if (state.completedSentences >= state.currentSentences.length) {
            showTopicCongratulations();
            return;
        }
        
        const currentData = state.currentSentences[state.currentSentenceIndex];
        
        state.originalSentence = currentData.en;
        state.mistakeCount = 0;
        
        elements.meaning.innerHTML = `<span>&ldquo;${currentData.vi}&rdquo;</span><span>${currentData.emoji}</span>`;
        elements.message.textContent = '';
        elements.message.style.color = 'var(--error-color)';
                
        const input = elements.answerInput;
        input.value = '';
        input.disabled = false;
        input.classList.remove('correct', 'incorrect');
        input.focus();
        
        elements.checkBtn.disabled = false;
        elements.listenAgainBtn.disabled = false;
        elements.hintBtn.disabled = false;
        
        updateScoreDisplay();
        startAudioLoop(); // Báº¯t Ä‘áº§u Ä‘á»c tá»± Ä‘á»™ng 2 láº§n
    }

    function handleCheckAnswer() {
        if(elements.checkBtn.disabled) return;

        const userAnswer = elements.answerInput.value.trim();
        const correctAnswer = state.originalSentence;

        if (userAnswer === correctAnswer) {
            elements.answerInput.classList.remove('incorrect');
            elements.answerInput.classList.add('correct');
            elements.answerInput.disabled = true;
            elements.checkBtn.disabled = true;
            elements.hintBtn.disabled = true;
            stopAudioLoop(true); // Dá»«ng hoÃ n toÃ n viá»‡c Ä‘á»c
            
            if (state.mistakeCount < 3) {
                state.score += 10;
                state.correctlyAnsweredCount++;
                elements.message.textContent = 'ChÃ­nh xÃ¡c! +10 Ä‘iá»ƒm.';
                elements.message.style.color = 'var(--success-color)';
            }
                                
            state.completedSentences++;
            state.currentSentenceIndex++;
            updateScoreDisplay();
            
            // YÃªu cáº§u má»›i: Äá»c láº¡i cÃ¢u Ä‘Ãºng má»™t láº§n ná»¯a sau khi hoÃ n thÃ nh
            speak(correctAnswer, () => {
                state.nextSentenceTimeoutId = setTimeout(startNewSentence, 2000);
            });
        } else {
            state.mistakeCount++;
            elements.answerInput.classList.add('incorrect');
            setTimeout(() => {
                elements.answerInput.classList.remove('incorrect');
            }, 500);

            if (state.mistakeCount >= 3) {
                elements.answerInput.disabled = true;
                elements.checkBtn.disabled = true;
                elements.hintBtn.disabled = true;
                stopAudioLoop(true);

                elements.message.textContent = `Báº¡n Ä‘Ã£ sai 3 láº§n. ÄÃ¡p Ã¡n Ä‘Ãºng: "${correctAnswer}"`;
                
                state.completedSentences++;
                state.currentSentenceIndex++;
                updateScoreDisplay();

                state.nextSentenceTimeoutId = setTimeout(startNewSentence, 3500);
            } else {
                elements.message.textContent = `Sai rá»“i! (Sá»‘ láº§n sai: ${state.mistakeCount}/3)`;
            }
        }
    }

    function showTopicCongratulations() {
        elements.gameScreen.style.display = 'none';
        elements.topicCongratsScreen.style.display = 'flex';
        elements.congratsMessage.innerHTML = `ChÃºc má»«ng <strong>${state.playerName}</strong>!<br>Báº¡n Ä‘Ã£ Ä‘áº¡t ${state.score} Ä‘iá»ƒm, hoÃ n thÃ nh Ä‘Ãºng ${state.correctlyAnsweredCount}/${state.currentSentences.length} cÃ¢u trong chá»§ Ä‘á» "${state.currentTopic}".`;
        startFireworks();
    }

    function showTopicSelection() {
        stopAudioLoop(true);
        stopFireworks();
        elements.gameScreen.style.display = 'none';
        elements.topicCongratsScreen.style.display = 'none';
        // Äáº£m báº£o mÃ n hÃ¬nh báº¯t Ä‘áº§u cÅ©ng áº©n náº¿u chá»n chá»§ Ä‘á» má»›i
        elements.startScreen.style.display = 'none'; 
        elements.topicSelectionScreen.style.display = 'flex';
        elements.gameSubtitle.textContent = "(Dictation Practice)";
    }

    function startGame(topic) {
        initializeState();
        state.currentTopic = topic;
        // Trá»™n ngáº«u nhiÃªn danh sÃ¡ch cÃ¢u trÆ°á»›c khi chÆ¡i
        const shuffledSentences = [...topics[topic]].sort(() => Math.random() - 0.5);
        state.currentSentences = shuffledSentences;
        
        elements.gameSubtitle.textContent = `Chá»§ Ä‘á»: ${topic}`;
        elements.topicSelectionScreen.style.display = 'none';
        elements.gameScreen.style.display = 'block';
        startNewSentence();
    }

    function createTopicButtons() {
        const topicContainer = elements.topicSelectionScreen;
        topicContainer.innerHTML = ''; // Clear existing buttons
        let colorIndex = 1;
        for (const topic in topics) {
            const button = document.createElement('button');
            button.className = `topic-btn topic-btn-color-${colorIndex}`;
            button.textContent = topic;
            button.onclick = () => startGame(topic);
            topicContainer.appendChild(button);
            colorIndex = (colorIndex % 3) + 1; // Now we have 3 topics
        }
    }

    function setupEventListeners() {
        elements.startBtn.addEventListener('click', () => {
            const playerName = elements.playerNameInput.value.trim();
            if (playerName) {
                state.playerName = playerName;
                elements.startScreen.style.display = 'none';
                elements.topicSelectionScreen.style.display = 'flex';
                // XÃ³a thÃ´ng bÃ¡o lá»—i cÅ© náº¿u cÃ³
                elements.message.textContent = '';
            } else {
                // Thay tháº¿ alert báº±ng UI message box
                elements.message.textContent = "Vui lÃ²ng nháº­p tÃªn cá»§a báº¡n!";
                elements.message.style.color = 'var(--error-color)';
                elements.playerNameInput.focus();
                setTimeout(() => { elements.message.textContent = ''; }, 3000);
            }
        });

        elements.listenAgainBtn.addEventListener('click', () => {
            if (!state.isSpeaking) {
                // Chá»‰ cáº§n gá»i speak, vÃ¬ hÃ m nÃ y sáº½ dá»«ng má»i lá»i nÃ³i khÃ¡c (hÃ m láº·p Ä‘Ã£ bá»‹ stopAudioLoop loáº¡i bá»)
                speak(state.originalSentence);
            }
        });

        elements.resetBtn.addEventListener('click', showTopicSelection);

        elements.playTopicAgainBtn.addEventListener('click', () => {
            stopFireworks();
            elements.topicCongratsScreen.style.display = 'none';
            startGame(state.currentTopic);
        });

        elements.chooseAnotherTopicBtn.addEventListener('click', showTopicSelection);

        // Listeners for Dictation Game
        elements.checkBtn.addEventListener('click', handleCheckAnswer);
        elements.answerInput.addEventListener('keydown', (e) => {
            if (e.key === 'Enter' && !elements.checkBtn.disabled) {
                handleCheckAnswer();
            }
        });
        
        const showHint = () => {
            elements.hint.textContent = state.originalSentence;
            elements.hint.style.display = 'block';
        };
        
        const hideHint = () => {
            elements.hint.style.display = 'none';
        };
        
        elements.hintBtn.addEventListener('mousedown', showHint);
        elements.hintBtn.addEventListener('mouseup', hideHint);
        elements.hintBtn.addEventListener('mouseleave', hideHint);
        elements.hintBtn.addEventListener('touchstart', (e) => { e.preventDefault(); showHint(); });
        elements.hintBtn.addEventListener('touchend', hideHint);
    }

    // --- Fireworks Animation ---
    let fireworksRunning = false;
    let fireworks = []; 
    let particles = [];
    let hue = 120; 

    function Firework(sx, sy, tx, ty) {
        this.x = sx; this.y = sy; this.sx = sx; this.sy = sy;
        this.tx = tx; this.ty = ty;
        const angle = Math.atan2(ty - sy, tx - sx); this.speed = 2;
        this.vx = Math.cos(angle) * this.speed; this.vy = Math.sin(angle) * this.speed;
        this.hue = hue;
    }
    
    function Particle(x, y, hue) {
        this.x = x; this.y = y; this.angle = random(0, Math.PI * 2);
        this.speed = random(1, 5);
        this.vx = Math.cos(this.angle) * this.speed;
        this.vy = Math.sin(this.angle) * this.speed;
        this.hue = hue; this.alpha = 1;
    }

    function random(min, max) { return Math.random() * (max - min) + min; }
    
    function createParticles(x, y, hue) {
         for (let i = 0; i < 30; i++) {
             particles.push(new Particle(x, y, hue));
         }
    }

    Firework.prototype.update = function(index) {
        const ctx = elements.canvas.getContext('2d');
        this.x += this.vx; this.y += this.vy;
        if (Math.sqrt(Math.pow(this.tx - this.x, 2) + Math.pow(this.ty - this.y, 2)) <= this.speed) {
            const currentHue = this.hue;
            createParticles(this.tx, this.ty, currentHue);
            fireworks.splice(index, 1);
        }
    };
    
    Firework.prototype.draw = function() {
        const ctx = elements.canvas.getContext('2d');
        ctx.beginPath(); ctx.moveTo(this.x, this.y);
        ctx.lineTo(this.x - this.vx * 3, this.y - this.vy * 3);
        ctx.strokeStyle = `hsl(${this.hue}, 100%, 50%)`; ctx.stroke();
    };
    
    Particle.prototype.update = function(index) {
        this.x += this.vx; this.y += this.vy; this.alpha -= 0.01;
        if (this.alpha <= 0) particles.splice(index, 1);
    };
    
    Particle.prototype.draw = function(ctx) {
        ctx.save(); ctx.globalAlpha = this.alpha;
        ctx.beginPath(); ctx.arc(this.x, this.y, 1.5, 0, Math.PI * 2, false);
        ctx.fillStyle = `hsl(${this.hue}, 100%, 50%)`; ctx.fill();
        ctx.restore();
    };
    
    function startFireworks() {
        if (fireworksRunning) return;
        fireworksRunning = true;
        const ctx = elements.canvas.getContext('2d');
        
        fireworks = [];
        particles = [];
        hue = 120;

        function setCanvasSize() {
            elements.canvas.width = window.innerWidth;
            elements.canvas.height = window.innerHeight;
        }

        setCanvasSize();
        window.addEventListener('resize', setCanvasSize);

        function loop() {
            if (!fireworksRunning) {
                ctx.clearRect(0, 0, elements.canvas.width, elements.canvas.height);
                return;
            }
            
            requestAnimationFrame(loop);
            hue += 0.5;
            ctx.globalCompositeOperation = 'destination-out';
            ctx.fillStyle = 'rgba(0, 0, 0, 0.5)';
            ctx.fillRect(0, 0, elements.canvas.width, elements.canvas.height);
            ctx.globalCompositeOperation = 'lighter';
            
            if (Math.random() < 0.05) {
                fireworks.push(new Firework(random(0, elements.canvas.width), elements.canvas.height, random(0, elements.canvas.width), random(0, elements.canvas.height / 2)));
            }
            
            for (let i = fireworks.length - 1; i >= 0; i--) { fireworks[i].update(i); fireworks[i].draw(); }
            for (let i = particles.length - 1; i >= 0; i--) { particles[i].update(i); particles[i].draw(ctx); }
        }
        
        loop();
    }

    function stopFireworks() {
        fireworksRunning = false;
    }

    // --- Initial Load ---
    window.onload = () => {
        initializeState();
        initializeSpeech();
        createTopicButtons();
        setupEventListeners();
    };

    </script>
</body>
</html>
